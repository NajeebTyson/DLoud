var cov_21wmvvf5r9=function(){var path='/home/najeeb/Workspace/webstorm/DocSync/routes/appApi.js',hash='3a7c83f46383dcaeea626f1a90834ad6f84b0cc9',Function=function(){}.constructor,global=new Function('return this')(),gcv='__coverage__',coverageData={path:'/home/najeeb/Workspace/webstorm/DocSync/routes/appApi.js',statementMap:{'0':{start:{line:1,column:14},end:{line:1,column:32}},'1':{start:{line:2,column:15},end:{line:2,column:34}},'2':{start:{line:3,column:9},end:{line:3,column:28}},'3':{start:{line:4,column:15},end:{line:4,column:32}},'4':{start:{line:6,column:13},end:{line:6,column:29}},'5':{start:{line:8,column:12},end:{line:8,column:45}},'6':{start:{line:9,column:12},end:{line:9,column:38}},'7':{start:{line:10,column:12},end:{line:10,column:38}},'8':{start:{line:11,column:16},end:{line:11,column:46}},'9':{start:{line:12,column:11},end:{line:12,column:36}},'10':{start:{line:14,column:0},end:{line:20,column:3}},'11':{start:{line:15,column:13},end:{line:15,column:36}},'12':{start:{line:16,column:4},end:{line:19,column:7}},'13':{start:{line:17,column:8},end:{line:17,column:24}},'14':{start:{line:18,column:8},end:{line:18,column:23}},'15':{start:{line:22,column:0},end:{line:39,column:3}},'16':{start:{line:23,column:19},end:{line:23,column:36}},'17':{start:{line:24,column:15},end:{line:24,column:43}},'18':{start:{line:25,column:20},end:{line:25,column:36}},'19':{start:{line:25,column:47},end:{line:25,column:62}},'20':{start:{line:26,column:13},end:{line:26,column:36}},'21':{start:{line:27,column:4},end:{line:38,column:7}},'22':{start:{line:36,column:8},end:{line:36,column:24}},'23':{start:{line:37,column:8},end:{line:37,column:33}},'24':{start:{line:41,column:0},end:{line:53,column:3}},'25':{start:{line:42,column:4},end:{line:43,column:15}},'26':{start:{line:43,column:8},end:{line:43,column:15}},'27':{start:{line:45,column:4},end:{line:45,column:33}},'28':{start:{line:46,column:4},end:{line:51,column:7}},'29':{start:{line:47,column:7},end:{line:49,column:11}},'30':{start:{line:50,column:8},end:{line:50,column:24}},'31':{start:{line:52,column:4},end:{line:52,column:20}},'32':{start:{line:56,column:0},end:{line:65,column:3}},'33':{start:{line:57,column:12},end:{line:57,column:35}},'34':{start:{line:58,column:4},end:{line:64,column:7}},'35':{start:{line:59,column:8},end:{line:62,column:9}},'36':{start:{line:60,column:12},end:{line:60,column:27}},'37':{start:{line:61,column:12},end:{line:61,column:28}},'38':{start:{line:63,column:8},end:{line:63,column:24}},'39':{start:{line:67,column:0},end:{line:118,column:3}},'40':{start:{line:68,column:13},end:{line:68,column:36}},'41':{start:{line:69,column:4},end:{line:117,column:7}},'42':{start:{line:70,column:8},end:{line:116,column:9}},'43':{start:{line:71,column:12},end:{line:73,column:15}},'44':{start:{line:74,column:12},end:{line:74,column:28}},'45':{start:{line:75,column:14},end:{line:116,column:9}},'46':{start:{line:76,column:12},end:{line:78,column:15}},'47':{start:{line:79,column:12},end:{line:79,column:28}},'48':{start:{line:81,column:27},end:{line:92,column:14}},'49':{start:{line:94,column:12},end:{line:115,column:15}},'50':{start:{line:95,column:16},end:{line:114,column:17}},'51':{start:{line:96,column:20},end:{line:98,column:23}},'52':{start:{line:99,column:20},end:{line:99,column:36}},'53':{start:{line:101,column:20},end:{line:103,column:23}},'54':{start:{line:104,column:36},end:{line:110,column:22}},'55':{start:{line:111,column:20},end:{line:113,column:22}},'56':{start:{line:112,column:24},end:{line:112,column:40}},'57':{start:{line:120,column:0},end:{line:142,column:3}},'58':{start:{line:121,column:13},end:{line:121,column:36}},'59':{start:{line:122,column:4},end:{line:141,column:7}},'60':{start:{line:123,column:8},end:{line:139,column:9}},'61':{start:{line:124,column:12},end:{line:124,column:34}},'62':{start:{line:125,column:24},end:{line:132,column:14}},'63':{start:{line:133,column:12},end:{line:133,column:31}},'64':{start:{line:135,column:12},end:{line:138,column:15}},'65':{start:{line:136,column:16},end:{line:136,column:41}},'66':{start:{line:137,column:16},end:{line:137,column:32}},'67':{start:{line:140,column:8},end:{line:140,column:24}},'68':{start:{line:144,column:0},end:{line:172,column:3}},'69':{start:{line:145,column:13},end:{line:145,column:36}},'70':{start:{line:146,column:4},end:{line:171,column:7}},'71':{start:{line:147,column:8},end:{line:169,column:9}},'72':{start:{line:148,column:25},end:{line:148,column:89}},'73':{start:{line:149,column:12},end:{line:149,column:56}},'74':{start:{line:150,column:12},end:{line:168,column:15}},'75':{start:{line:154,column:16},end:{line:167,column:17}},'76':{start:{line:155,column:32},end:{line:162,column:22}},'77':{start:{line:163,column:29},end:{line:163,column:52}},'78':{start:{line:164,column:20},end:{line:166,column:23}},'79':{start:{line:165,column:24},end:{line:165,column:40}},'80':{start:{line:170,column:8},end:{line:170,column:24}},'81':{start:{line:174,column:0},end:{line:194,column:3}},'82':{start:{line:175,column:13},end:{line:175,column:36}},'83':{start:{line:176,column:4},end:{line:193,column:7}},'84':{start:{line:177,column:8},end:{line:192,column:9}},'85':{start:{line:178,column:12},end:{line:178,column:41}},'86':{start:{line:179,column:12},end:{line:179,column:28}},'87':{start:{line:181,column:24},end:{line:187,column:14}},'88':{start:{line:188,column:12},end:{line:190,column:15}},'89':{start:{line:189,column:16},end:{line:189,column:32}},'90':{start:{line:191,column:12},end:{line:191,column:42}},'91':{start:{line:196,column:0},end:{line:208,column:3}},'92':{start:{line:197,column:13},end:{line:197,column:45}},'93':{start:{line:198,column:4},end:{line:206,column:7}},'94':{start:{line:200,column:8},end:{line:200,column:36}},'95':{start:{line:201,column:8},end:{line:205,column:9}},'96':{start:{line:202,column:12},end:{line:202,column:41}},'97':{start:{line:204,column:12},end:{line:204,column:28}},'98':{start:{line:207,column:4},end:{line:207,column:32}},'99':{start:{line:210,column:0},end:{line:221,column:3}},'100':{start:{line:211,column:13},end:{line:211,column:45}},'101':{start:{line:212,column:4},end:{line:219,column:7}},'102':{start:{line:213,column:8},end:{line:213,column:36}},'103':{start:{line:215,column:8},end:{line:217,column:9}},'104':{start:{line:216,column:12},end:{line:216,column:41}},'105':{start:{line:218,column:8},end:{line:218,column:24}},'106':{start:{line:220,column:4},end:{line:220,column:32}},'107':{start:{line:223,column:0},end:{line:240,column:3}},'108':{start:{line:224,column:13},end:{line:224,column:45}},'109':{start:{line:225,column:4},end:{line:239,column:7}},'110':{start:{line:226,column:24},end:{line:233,column:10}},'111':{start:{line:234,column:8},end:{line:236,column:11}},'112':{start:{line:235,column:12},end:{line:235,column:40}},'113':{start:{line:237,column:8},end:{line:237,column:33}},'114':{start:{line:242,column:0},end:{line:258,column:3}},'115':{start:{line:243,column:13},end:{line:243,column:45}},'116':{start:{line:244,column:4},end:{line:257,column:7}},'117':{start:{line:245,column:24},end:{line:252,column:10}},'118':{start:{line:253,column:8},end:{line:255,column:11}},'119':{start:{line:254,column:12},end:{line:254,column:40}},'120':{start:{line:256,column:8},end:{line:256,column:33}},'121':{start:{line:261,column:0},end:{line:261,column:24}}},fnMap:{'0':{name:'(anonymous_0)',decl:{start:{line:14,column:37},end:{line:14,column:38}},loc:{start:{line:14,column:57},end:{line:20,column:1}},line:14},'1':{name:'(anonymous_1)',decl:{start:{line:16,column:38},end:{line:16,column:39}},loc:{start:{line:16,column:59},end:{line:19,column:5}},line:16},'2':{name:'(anonymous_2)',decl:{start:{line:22,column:40},end:{line:22,column:41}},loc:{start:{line:22,column:60},end:{line:39,column:1}},line:22},'3':{name:'(anonymous_3)',decl:{start:{line:35,column:7},end:{line:35,column:8}},loc:{start:{line:35,column:20},end:{line:38,column:5}},line:35},'4':{name:'(anonymous_4)',decl:{start:{line:41,column:48},end:{line:41,column:49}},loc:{start:{line:41,column:68},end:{line:53,column:1}},line:41},'5':{name:'(anonymous_5)',decl:{start:{line:46,column:118},end:{line:46,column:119}},loc:{start:{line:46,column:140},end:{line:51,column:5}},line:46},'6':{name:'(anonymous_6)',decl:{start:{line:56,column:47},end:{line:56,column:48}},loc:{start:{line:56,column:67},end:{line:65,column:1}},line:56},'7':{name:'(anonymous_7)',decl:{start:{line:58,column:67},end:{line:58,column:68}},loc:{start:{line:58,column:88},end:{line:64,column:5}},line:58},'8':{name:'(anonymous_8)',decl:{start:{line:67,column:66},end:{line:67,column:67}},loc:{start:{line:67,column:86},end:{line:118,column:1}},line:67},'9':{name:'(anonymous_9)',decl:{start:{line:69,column:68},end:{line:69,column:69}},loc:{start:{line:69,column:91},end:{line:117,column:5}},line:69},'10':{name:'(anonymous_10)',decl:{start:{line:94,column:26},end:{line:94,column:27}},loc:{start:{line:94,column:48},end:{line:115,column:13}},line:94},'11':{name:'(anonymous_11)',decl:{start:{line:111,column:35},end:{line:111,column:36}},loc:{start:{line:111,column:47},end:{line:113,column:21}},line:111},'12':{name:'(anonymous_12)',decl:{start:{line:120,column:45},end:{line:120,column:46}},loc:{start:{line:120,column:65},end:{line:142,column:1}},line:120},'13':{name:'(anonymous_13)',decl:{start:{line:122,column:78},end:{line:122,column:79}},loc:{start:{line:122,column:103},end:{line:141,column:5}},line:122},'14':{name:'(anonymous_14)',decl:{start:{line:135,column:23},end:{line:135,column:24}},loc:{start:{line:135,column:35},end:{line:138,column:13}},line:135},'15':{name:'(anonymous_15)',decl:{start:{line:144,column:61},end:{line:144,column:62}},loc:{start:{line:144,column:81},end:{line:172,column:1}},line:144},'16':{name:'(anonymous_16)',decl:{start:{line:146,column:136},end:{line:146,column:137}},loc:{start:{line:146,column:157},end:{line:171,column:5}},line:146},'17':{name:'(anonymous_17)',decl:{start:{line:150,column:33},end:{line:150,column:34}},loc:{start:{line:150,column:45},end:{line:168,column:13}},line:150},'18':{name:'(anonymous_18)',decl:{start:{line:164,column:31},end:{line:164,column:32}},loc:{start:{line:164,column:43},end:{line:166,column:21}},line:164},'19':{name:'(anonymous_19)',decl:{start:{line:174,column:59},end:{line:174,column:60}},loc:{start:{line:174,column:79},end:{line:194,column:1}},line:174},'20':{name:'(anonymous_20)',decl:{start:{line:176,column:91},end:{line:176,column:92}},loc:{start:{line:176,column:106},end:{line:193,column:5}},line:176},'21':{name:'(anonymous_21)',decl:{start:{line:188,column:23},end:{line:188,column:24}},loc:{start:{line:188,column:35},end:{line:190,column:13}},line:188},'22':{name:'(anonymous_22)',decl:{start:{line:196,column:49},end:{line:196,column:50}},loc:{start:{line:196,column:69},end:{line:208,column:1}},line:196},'23':{name:'(anonymous_23)',decl:{start:{line:198,column:98},end:{line:198,column:99}},loc:{start:{line:198,column:120},end:{line:206,column:5}},line:198},'24':{name:'(anonymous_24)',decl:{start:{line:210,column:51},end:{line:210,column:52}},loc:{start:{line:210,column:71},end:{line:221,column:1}},line:210},'25':{name:'(anonymous_25)',decl:{start:{line:212,column:107},end:{line:212,column:108}},loc:{start:{line:212,column:129},end:{line:219,column:5}},line:212},'26':{name:'(anonymous_26)',decl:{start:{line:223,column:59},end:{line:223,column:60}},loc:{start:{line:223,column:79},end:{line:240,column:1}},line:223},'27':{name:'(anonymous_27)',decl:{start:{line:225,column:139},end:{line:225,column:140}},loc:{start:{line:225,column:152},end:{line:239,column:5}},line:225},'28':{name:'(anonymous_28)',decl:{start:{line:234,column:23},end:{line:234,column:24}},loc:{start:{line:234,column:35},end:{line:236,column:9}},line:234},'29':{name:'(anonymous_29)',decl:{start:{line:242,column:62},end:{line:242,column:63}},loc:{start:{line:242,column:82},end:{line:258,column:1}},line:242},'30':{name:'(anonymous_30)',decl:{start:{line:244,column:139},end:{line:244,column:140}},loc:{start:{line:244,column:152},end:{line:257,column:5}},line:244},'31':{name:'(anonymous_31)',decl:{start:{line:253,column:23},end:{line:253,column:24}},loc:{start:{line:253,column:35},end:{line:255,column:9}},line:253}},branchMap:{'0':{loc:{start:{line:42,column:4},end:{line:43,column:15}},type:'if',locations:[{start:{line:42,column:4},end:{line:43,column:15}},{start:{line:42,column:4},end:{line:43,column:15}}],line:42},'1':{loc:{start:{line:59,column:8},end:{line:62,column:9}},type:'if',locations:[{start:{line:59,column:8},end:{line:62,column:9}},{start:{line:59,column:8},end:{line:62,column:9}}],line:59},'2':{loc:{start:{line:70,column:8},end:{line:116,column:9}},type:'if',locations:[{start:{line:70,column:8},end:{line:116,column:9}},{start:{line:70,column:8},end:{line:116,column:9}}],line:70},'3':{loc:{start:{line:75,column:14},end:{line:116,column:9}},type:'if',locations:[{start:{line:75,column:14},end:{line:116,column:9}},{start:{line:75,column:14},end:{line:116,column:9}}],line:75},'4':{loc:{start:{line:95,column:16},end:{line:114,column:17}},type:'if',locations:[{start:{line:95,column:16},end:{line:114,column:17}},{start:{line:95,column:16},end:{line:114,column:17}}],line:95},'5':{loc:{start:{line:123,column:8},end:{line:139,column:9}},type:'if',locations:[{start:{line:123,column:8},end:{line:139,column:9}},{start:{line:123,column:8},end:{line:139,column:9}}],line:123},'6':{loc:{start:{line:147,column:8},end:{line:169,column:9}},type:'if',locations:[{start:{line:147,column:8},end:{line:169,column:9}},{start:{line:147,column:8},end:{line:169,column:9}}],line:147},'7':{loc:{start:{line:154,column:16},end:{line:167,column:17}},type:'if',locations:[{start:{line:154,column:16},end:{line:167,column:17}},{start:{line:154,column:16},end:{line:167,column:17}}],line:154},'8':{loc:{start:{line:177,column:8},end:{line:192,column:9}},type:'if',locations:[{start:{line:177,column:8},end:{line:192,column:9}},{start:{line:177,column:8},end:{line:192,column:9}}],line:177},'9':{loc:{start:{line:201,column:8},end:{line:205,column:9}},type:'if',locations:[{start:{line:201,column:8},end:{line:205,column:9}},{start:{line:201,column:8},end:{line:205,column:9}}],line:201},'10':{loc:{start:{line:215,column:8},end:{line:217,column:9}},type:'if',locations:[{start:{line:215,column:8},end:{line:217,column:9}},{start:{line:215,column:8},end:{line:217,column:9}}],line:215}},s:{'0':0,'1':0,'2':0,'3':0,'4':0,'5':0,'6':0,'7':0,'8':0,'9':0,'10':0,'11':0,'12':0,'13':0,'14':0,'15':0,'16':0,'17':0,'18':0,'19':0,'20':0,'21':0,'22':0,'23':0,'24':0,'25':0,'26':0,'27':0,'28':0,'29':0,'30':0,'31':0,'32':0,'33':0,'34':0,'35':0,'36':0,'37':0,'38':0,'39':0,'40':0,'41':0,'42':0,'43':0,'44':0,'45':0,'46':0,'47':0,'48':0,'49':0,'50':0,'51':0,'52':0,'53':0,'54':0,'55':0,'56':0,'57':0,'58':0,'59':0,'60':0,'61':0,'62':0,'63':0,'64':0,'65':0,'66':0,'67':0,'68':0,'69':0,'70':0,'71':0,'72':0,'73':0,'74':0,'75':0,'76':0,'77':0,'78':0,'79':0,'80':0,'81':0,'82':0,'83':0,'84':0,'85':0,'86':0,'87':0,'88':0,'89':0,'90':0,'91':0,'92':0,'93':0,'94':0,'95':0,'96':0,'97':0,'98':0,'99':0,'100':0,'101':0,'102':0,'103':0,'104':0,'105':0,'106':0,'107':0,'108':0,'109':0,'110':0,'111':0,'112':0,'113':0,'114':0,'115':0,'116':0,'117':0,'118':0,'119':0,'120':0,'121':0},f:{'0':0,'1':0,'2':0,'3':0,'4':0,'5':0,'6':0,'7':0,'8':0,'9':0,'10':0,'11':0,'12':0,'13':0,'14':0,'15':0,'16':0,'17':0,'18':0,'19':0,'20':0,'21':0,'22':0,'23':0,'24':0,'25':0,'26':0,'27':0,'28':0,'29':0,'30':0,'31':0},b:{'0':[0,0],'1':[0,0],'2':[0,0],'3':[0,0],'4':[0,0],'5':[0,0],'6':[0,0],'7':[0,0],'8':[0,0],'9':[0,0],'10':[0,0]},_coverageSchema:'332fd63041d2c1bcb487cc26dd0d5f7d97098a6c'},coverage=global[gcv]||(global[gcv]={});if(coverage[path]&&coverage[path].hash===hash){return coverage[path];}coverageData.hash=hash;return coverage[path]=coverageData;}();var express=(cov_21wmvvf5r9.s[0]++,require('express'));var mongoose=(cov_21wmvvf5r9.s[1]++,require("mongoose"));var fs=(cov_21wmvvf5r9.s[2]++,require('fs-extra'));var ObjectId=(cov_21wmvvf5r9.s[3]++,mongoose.ObjectId);var router=(cov_21wmvvf5r9.s[4]++,express.Router());var dbUrl=(cov_21wmvvf5r9.s[5]++,require("../config/configDB").url);var Drive=(cov_21wmvvf5r9.s[6]++,require("../models/drive"));var Users=(cov_21wmvvf5r9.s[7]++,require("../models/users"));var LogModels=(cov_21wmvvf5r9.s[8]++,require("../models/logModels"));var Quiz=(cov_21wmvvf5r9.s[9]++,require("../models/quiz"));cov_21wmvvf5r9.s[10]++;router.get("/dloud/quiz/data/:qId?",function(req,res){cov_21wmvvf5r9.f[0]++;var db=(cov_21wmvvf5r9.s[11]++,mongoose.connect(dbUrl));cov_21wmvvf5r9.s[12]++;Quiz.find({'_id':req.query.qId},function(err,data){cov_21wmvvf5r9.f[1]++;cov_21wmvvf5r9.s[13]++;db.disconnect();cov_21wmvvf5r9.s[14]++;res.json(data);});});cov_21wmvvf5r9.s[15]++;router.post("/dloud/quiz/add-question",function(req,res){cov_21wmvvf5r9.f[2]++;var question=(cov_21wmvvf5r9.s[16]++,req.body.question),qOptions=(cov_21wmvvf5r9.s[17]++,req.body.qOptions.split("&")),correctOption=(cov_21wmvvf5r9.s[18]++,req.body.cOption),quizId=(cov_21wmvvf5r9.s[19]++,req.body.quizId);var db=(cov_21wmvvf5r9.s[20]++,mongoose.connect(dbUrl));cov_21wmvvf5r9.s[21]++;Quiz.findByIdAndUpdate(quizId,{"$push":{"questions":{question:question,qOptions:qOptions,correctOption:correctOption}},"$inc":{'countQuestions':1}},function(err){cov_21wmvvf5r9.f[3]++;cov_21wmvvf5r9.s[22]++;db.disconnect();cov_21wmvvf5r9.s[23]++;res.json({status:"OK"});});});cov_21wmvvf5r9.s[24]++;router.get("/dloud/drive/files/:parentFolder?",function(req,res){cov_21wmvvf5r9.f[4]++;cov_21wmvvf5r9.s[25]++;if(req.query.parentFolder==='undefined'){cov_21wmvvf5r9.b[0][0]++;cov_21wmvvf5r9.s[26]++;return;}else{cov_21wmvvf5r9.b[0][1]++;}var db;cov_21wmvvf5r9.s[27]++;db=mongoose.connect(dbUrl);cov_21wmvvf5r9.s[28]++;Drive.find({'parent':req.query.parentFolder}).select('_id name fType createdAt updatedAt data.contentType').exec(function(err,files){cov_21wmvvf5r9.f[5]++;cov_21wmvvf5r9.s[29]++;res.json({files:files});cov_21wmvvf5r9.s[30]++;db.disconnect();});cov_21wmvvf5r9.s[31]++;db.disconnect();});cov_21wmvvf5r9.s[32]++;router.get("/dloud/drive/openFile/:filename?",function(req,res){cov_21wmvvf5r9.f[6]++;var db=(cov_21wmvvf5r9.s[33]++,mongoose.connect(dbUrl));cov_21wmvvf5r9.s[34]++;Drive.findOne({'shortname':req.query.filename.toLowerCase()},function(err,file){cov_21wmvvf5r9.f[7]++;cov_21wmvvf5r9.s[35]++;if(file){cov_21wmvvf5r9.b[1][0]++;cov_21wmvvf5r9.s[36]++;res.json(file);cov_21wmvvf5r9.s[37]++;db.disconnect();}else{cov_21wmvvf5r9.b[1][1]++;}cov_21wmvvf5r9.s[38]++;db.disconnect();});});cov_21wmvvf5r9.s[39]++;router.get("/dloud/drive/make_folder/:newFolder?/:parentFolder?",function(req,res){cov_21wmvvf5r9.f[8]++;var db=(cov_21wmvvf5r9.s[40]++,mongoose.connect(dbUrl));cov_21wmvvf5r9.s[41]++;Drive.findOne({'shortname':req.query.newFolder.toLowerCase()},function(err,folder){cov_21wmvvf5r9.f[9]++;cov_21wmvvf5r9.s[42]++;if(folder){cov_21wmvvf5r9.b[2][0]++;cov_21wmvvf5r9.s[43]++;res.json({status:'already'});cov_21wmvvf5r9.s[44]++;db.disconnect();}else{cov_21wmvvf5r9.b[2][1]++;cov_21wmvvf5r9.s[45]++;if(err){cov_21wmvvf5r9.b[3][0]++;cov_21wmvvf5r9.s[46]++;res.json({status:'error'});cov_21wmvvf5r9.s[47]++;db.disconnect();}else{cov_21wmvvf5r9.b[3][1]++;var newDrive=(cov_21wmvvf5r9.s[48]++,new Drive({name:req.query.newFolder,shortname:req.query.newFolder.toLowerCase(),fType:'folder',parent:req.query.parentFolder,childs:null,creator:req.user._id,data:{content:null,contentType:null}}));cov_21wmvvf5r9.s[49]++;newDrive.save(function(err,drive){cov_21wmvvf5r9.f[10]++;cov_21wmvvf5r9.s[50]++;if(err){cov_21wmvvf5r9.b[4][0]++;cov_21wmvvf5r9.s[51]++;res.json({status:'errorSave'});cov_21wmvvf5r9.s[52]++;db.disconnect();}else{cov_21wmvvf5r9.b[4][1]++;cov_21wmvvf5r9.s[53]++;res.json({status:'done'});var newFolder=(cov_21wmvvf5r9.s[54]++,new LogModels.createFolderLog({username:req.user.local.username,userId:req.user._id,folderId:drive._id,folderName:drive.name,userIp:req._remoteAddress}));cov_21wmvvf5r9.s[55]++;newFolder.save(function(){cov_21wmvvf5r9.f[11]++;cov_21wmvvf5r9.s[56]++;db.disconnect();});}});}}});});cov_21wmvvf5r9.s[57]++;router.post("/dloud/drive/download-request",function(req,res){cov_21wmvvf5r9.f[12]++;var db=(cov_21wmvvf5r9.s[58]++,mongoose.connect(dbUrl));cov_21wmvvf5r9.s[59]++;Users.findOne({'local.username':req.body.username,'_id':req.body._id},function(err,thisUser){cov_21wmvvf5r9.f[13]++;cov_21wmvvf5r9.s[60]++;if(thisUser){cov_21wmvvf5r9.b[5][0]++;cov_21wmvvf5r9.s[61]++;console.log(thisUser);var dFile=(cov_21wmvvf5r9.s[62]++,new LogModels.fileDownloadLog({username:thisUser.local.username,userId:thisUser._id,location:thisUser.area,fileId:req.body.fileId,filename:req.body.filename,userIp:req._remoteAddress}));cov_21wmvvf5r9.s[63]++;console.log(dFile);//var db = mongoose.connect(dbUrl);
cov_21wmvvf5r9.s[64]++;dFile.save(function(){cov_21wmvvf5r9.f[14]++;cov_21wmvvf5r9.s[65]++;res.json({status:'OK'});cov_21wmvvf5r9.s[66]++;db.disconnect();});}else{cov_21wmvvf5r9.b[5][1]++;}cov_21wmvvf5r9.s[67]++;db.disconnect();});});cov_21wmvvf5r9.s[68]++;router.get("/dloud/drive/download-file/:filename?/:fileId?",function(req,res){cov_21wmvvf5r9.f[15]++;var db=(cov_21wmvvf5r9.s[69]++,mongoose.connect(dbUrl));cov_21wmvvf5r9.s[70]++;Drive.findOne({'name':req.query.filename.toString(),_id:req.query.fileId}).select('data.content name data.contentType _id').exec(function(err,file){cov_21wmvvf5r9.f[16]++;cov_21wmvvf5r9.s[71]++;if(file){cov_21wmvvf5r9.b[6][0]++;var myfile=(cov_21wmvvf5r9.s[72]++,__dirname+'/../public/download/'+file.name+file.data.contentType);cov_21wmvvf5r9.s[73]++;fs.writeFileSync(myfile,file.data.content);cov_21wmvvf5r9.s[74]++;res.download(myfile,function(){cov_21wmvvf5r9.f[17]++;cov_21wmvvf5r9.s[75]++;/*setTimeout(function () {
                    fs.unlink(myfile);
                },20000);*/if(req.user){cov_21wmvvf5r9.b[7][0]++;var dFile=(cov_21wmvvf5r9.s[76]++,new LogModels.fileDownloadLog({username:req.user.local.username,userId:req.user._id,location:req.user.area,fileId:file._id,filename:file.name,userIp:req._remoteAddress}));var db=(cov_21wmvvf5r9.s[77]++,mongoose.connect(dbUrl));cov_21wmvvf5r9.s[78]++;dFile.save(function(){cov_21wmvvf5r9.f[18]++;cov_21wmvvf5r9.s[79]++;db.disconnect();});}else{cov_21wmvvf5r9.b[7][1]++;}});}else{cov_21wmvvf5r9.b[6][1]++;}cov_21wmvvf5r9.s[80]++;db.disconnect();});});cov_21wmvvf5r9.s[81]++;router.get("/dloud/drive/delete-file/:filename?/:fileId?",function(req,res){cov_21wmvvf5r9.f[19]++;var db=(cov_21wmvvf5r9.s[82]++,mongoose.connect(dbUrl));cov_21wmvvf5r9.s[83]++;Drive.findOneAndRemove({'name':req.query.filename.toString(),_id:req.query.fileId},function(err){cov_21wmvvf5r9.f[20]++;cov_21wmvvf5r9.s[84]++;if(err){cov_21wmvvf5r9.b[8][0]++;cov_21wmvvf5r9.s[85]++;res.json({status:'failed'});cov_21wmvvf5r9.s[86]++;db.disconnect();}else{cov_21wmvvf5r9.b[8][1]++;var dFile=(cov_21wmvvf5r9.s[87]++,new LogModels.fileDeleteLog({username:req.user.local.username,userId:req.user._id,fileId:req.query.fileId,filename:req.query.filename,userIp:req._remoteAddress}));cov_21wmvvf5r9.s[88]++;dFile.save(function(){cov_21wmvvf5r9.f[21]++;cov_21wmvvf5r9.s[89]++;db.disconnect();});cov_21wmvvf5r9.s[90]++;res.json({status:'removed'});}});});cov_21wmvvf5r9.s[91]++;router.get("/dloud/drive/members/:projectName?",function(req,res){cov_21wmvvf5r9.f[22]++;var db=(cov_21wmvvf5r9.s[92]++,mongoose.createConnection(dbUrl));cov_21wmvvf5r9.s[93]++;Users.find({'projects.name':req.query.projectName.toString()}).select('local.name _id').exec(function(err,users){cov_21wmvvf5r9.f[23]++;cov_21wmvvf5r9.s[94]++;// console.log(users);
mongoose.connection.close();cov_21wmvvf5r9.s[95]++;if(err){cov_21wmvvf5r9.b[9][0]++;cov_21wmvvf5r9.s[96]++;res.json({status:'failed'});}else{cov_21wmvvf5r9.b[9][1]++;cov_21wmvvf5r9.s[97]++;res.json(users);}});cov_21wmvvf5r9.s[98]++;mongoose.connection.close();});cov_21wmvvf5r9.s[99]++;router.get("/dloud/drive/all-users/:projectName?",function(req,res){cov_21wmvvf5r9.f[24]++;var db=(cov_21wmvvf5r9.s[100]++,mongoose.createConnection(dbUrl));cov_21wmvvf5r9.s[101]++;Users.find({'projects.name':{'$ne':req.query.projectName.toString()}}).select('local.name _id').exec(function(err,users){cov_21wmvvf5r9.f[25]++;cov_21wmvvf5r9.s[102]++;mongoose.connection.close();// console.log(users);
cov_21wmvvf5r9.s[103]++;if(err){cov_21wmvvf5r9.b[10][0]++;cov_21wmvvf5r9.s[104]++;res.json({status:'failed'});}else{cov_21wmvvf5r9.b[10][1]++;}cov_21wmvvf5r9.s[105]++;res.json(users);});cov_21wmvvf5r9.s[106]++;mongoose.connection.close();});cov_21wmvvf5r9.s[107]++;router.get("/dloud/drive/add-member/:projectName?/:user?",function(req,res){cov_21wmvvf5r9.f[26]++;var db=(cov_21wmvvf5r9.s[108]++,mongoose.createConnection(dbUrl));cov_21wmvvf5r9.s[109]++;Users.findByIdAndUpdate(req.query.user.toString(),{"$push":{"projects":{name:req.query.projectName.toString(),admin:false}}},function(err){cov_21wmvvf5r9.f[27]++;var addMember=(cov_21wmvvf5r9.s[110]++,new LogModels.removeMemberLog({username:req.user.local.username,userId:req.user._id,userIp:req._remoteAddress,// addedMemberId: String,
addedMemberId:req.query.user,projectName:req.query.projectName}));cov_21wmvvf5r9.s[111]++;addMember.save(function(){cov_21wmvvf5r9.f[28]++;cov_21wmvvf5r9.s[112]++;mongoose.connection.close();});cov_21wmvvf5r9.s[113]++;res.json({status:true});// db.disconnect();
});});cov_21wmvvf5r9.s[114]++;router.get("/dloud/drive/remove-member/:projectName?/:user?",function(req,res){cov_21wmvvf5r9.f[29]++;var db=(cov_21wmvvf5r9.s[115]++,mongoose.createConnection(dbUrl));cov_21wmvvf5r9.s[116]++;Users.findByIdAndUpdate(req.query.user.toString(),{"$pull":{"projects":{name:req.query.projectName.toString(),admin:false}}},function(err){cov_21wmvvf5r9.f[30]++;var remMember=(cov_21wmvvf5r9.s[117]++,new LogModels.removeMemberLog({username:req.user.local.username,userId:req.user._id,userIp:req._remoteAddress,// removedMemberId: String,
removedMemberId:req.query.user,projectName:req.query.projectName}));cov_21wmvvf5r9.s[118]++;remMember.save(function(){cov_21wmvvf5r9.f[31]++;cov_21wmvvf5r9.s[119]++;mongoose.connection.close();});cov_21wmvvf5r9.s[120]++;res.json({status:true});});});cov_21wmvvf5r9.s[121]++;module.exports=router;